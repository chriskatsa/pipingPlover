{"ts":1346097678266,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"dojo.require(\"esri.map\");\r\ndojo.require(\"esri.dijit.Legend\");\r\ndojo.require(\"esri.dijit.Scalebar\");\r\ndojo.require(\"esri.arcgis.utils\");\r\ndojo.require(\"esri.IdentityManager\");\r\ndojo.require(\"dijit.dijit\"); // optimize: load dijit layer\r\ndojo.require(\"dijit.layout.BorderContainer\");\r\ndojo.require(\"dijit.layout.ContentPane\");\r\n\r\nvar urlObject,\r\n    map;\r\n\r\nvar initMap = function(){\r\n\r\n    if(configOptions.geometryserviceurl && location.protocol === \"https:\"){\r\n        configOptions.geometryserviceurl = configOptions.geometryserviceurl.replace('http:','https:');\r\n    }\r\n    esri.config.defaults.geometryService = new esri.tasks.GeometryService(configOptions.geometryserviceurl);\r\n\r\n    if(!configOptions.sharingurl){\r\n        configOptions.sharingurl = location.protocol + '//' + location.host + \"/sharing/content/items\";\r\n    }\r\n    esri.arcgis.utils.arcgisUrl = configOptions.sharingurl;\r\n\r\n    urlObject = esri.urlToObject(document.location.href);\r\n    urlObject.query = urlObject.query || {};\r\n\r\n    createMap();\r\n\r\n    $(\"#title\").html(configOptions.title);\r\n    $(\"#subtitle\").html(configOptions.subtitle);\r\n    \r\n    $(\"#title\").html(configOptions.title);\r\n    $(\"#subtitle\").html(configOptions.subtitle);\r\n\r\n     $(\"#fader\").imageFader();\r\n\r\n};\r\n\r\nvar createMap = function(){\r\n    var mapDeferred = esri.arcgis.utils.createMap(configOptions.webmap,\"mapPane\",{\r\n        mapOptions: {\r\n            slider : true,\r\n            nav : false,\r\n            wrapAround180 : true\r\n        }\r\n    });\r\n\r\n    mapDeferred.addCallback(function(response){\r\n        map = response.map;\r\n\r\n        dojo.connect(dijit.byId(\"mapPane\"),\"resize\",map,map.resize);\r\n\r\n        var layers = response.itemInfo.itemData,operationalLayers;\r\n\r\n    });\r\n    mapDeferred.addErrback(function(error) {\r\n        console.log(\"Map creation failed: \", dojo.toJson(error));\r\n    });\r\n};"]],"start1":0,"start2":0,"length1":0,"length2":1860}]],"length":1860}
